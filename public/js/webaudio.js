// Generated by CoffeeScript 1.3.3
(function() {
  var WebAudio, audioContext;

  audioContext = window.audioContext || window.webkitAudioContext;

  window.WebAudio = WebAudio = {
    context: new audioContext(),
    playSound: function(buffer, start, duration, delay) {
      var source;
      if (duration == null) {
        duration = null;
      }
      if (delay == null) {
        delay = 0;
      }
      source = this.context.createBufferSource();
      source.buffer = buffer;
      source.connect(this.context.destination);
      if (!duration) {
        duration = buffer.duration - start;
      }
      source.noteGrainOn(this.context.currentTime + delay, start, duration);
      return source;
    },
    stopSound: function(source, delay) {
      if (delay == null) {
        delay = 0;
      }
      return source.noteOff(this.context.currentTime + delay);
    },
    record: function(duration, action, cb) {
      var _this = this;
      this.context = new audioContext(2, duration * 44100, 44100);
      this.context.oncomplete = function(e) {
        _this.context = new audioContext();
        return cb(e.renderedBuffer);
      };
      action();
      return this.context.startRendering();
    }
  };

}).call(this);
